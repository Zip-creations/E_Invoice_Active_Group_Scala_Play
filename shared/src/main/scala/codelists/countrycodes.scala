package codelists

import sharedUtility.validation._

import cats.data._
import cats.data.Validated._
import cats.syntax.all._


case class CountryCode(code: String) extends ValidateAble[String](code)
object CountryCode {
    private def matchStr (str: String): Option[CountryCode] = {
        CountryCodes.values.find(_.toString == "Code_" ++ str) match 
            case Some(_) =>
                Some(CountryCode(str))
            case None => 
                None
    }
    private def strInList(str: String): Boolean = {
        matchStr(str).isDefined
    }
    def validate(code: String): Validated[Seq[ErrorMessage], CountryCode] = {
        Validated.cond(
            CountryCode.strInList(code),
            CountryCode.matchStr(code).get,
            Seq(ValueNotInCodelistError(code))
        )
    }
}

// Added Code_ to enable the Enum to work with codes that start with numbers, and preserve uniformity
enum CountryCodes {
    case
     Code_AD,
     Code_AE,
     Code_AF,
     Code_AG,
     Code_AI,
     Code_AL,
     Code_AM,
     Code_AO,
     Code_AQ,
     Code_AR,
     Code_AS,
     Code_AT,
     Code_AU,
     Code_AW,
     Code_AX,
     Code_AZ,
     Code_BA,
     Code_BB,
     Code_BD,
     Code_BE,
     Code_BF,
     Code_BG,
     Code_BH,
     Code_BI,
     Code_BJ,
     Code_BL,
     Code_BM,
     Code_BN,
     Code_BO,
     Code_BQ,
     Code_BR,
     Code_BS,
     Code_BT,
     Code_BV,
     Code_BW,
     Code_BY,
     Code_BZ,
     Code_CA,
     Code_CC,
     Code_CD,
     Code_CF,
     Code_CG,
     Code_CH,
     Code_CI,
     Code_CK,
     Code_CL,
     Code_CM,
     Code_CN,
     Code_CO,
     Code_CR,
     Code_CU,
     Code_CV,
     Code_CW,
     Code_CX,
     Code_CY,
     Code_CZ,
     Code_DE,
     Code_DJ,
     Code_DK,
     Code_DM,
     Code_DO,
     Code_DZ,
     Code_EC,
     Code_EE,
     Code_EG,
     Code_EH,
     Code_ER,
     Code_ES,
     Code_ET,
     Code_FI,
     Code_FJ,
     Code_FK,
     Code_FM,
     Code_FO,
     Code_FR,
     Code_GA,
     Code_GB,
     Code_GD,
     Code_GE,
     Code_GF,
     Code_GG,
     Code_GH,
     Code_GI,
     Code_GL,
     Code_GM,
     Code_GN,
     Code_GP,
     Code_GQ,
     Code_GR,
     Code_GS,
     Code_GT,
     Code_GU,
     Code_GW,
     Code_GY,
     Code_HK,
     Code_HM,
     Code_HN,
     Code_HR,
     Code_HT,
     Code_HU,
     Code_ID,
     Code_IE,
     Code_IL,
     Code_IM,
     Code_IN,
     Code_IO,
     Code_IQ,
     Code_IR,
     Code_IS,
     Code_IT,
     Code_JE,
     Code_JM,
     Code_JO,
     Code_JP,
     Code_KE,
     Code_KG,
     Code_KH,
     Code_KI,
     Code_KM,
     Code_KN,
     Code_KP,
     Code_KR,
     Code_KW,
     Code_KY,
     Code_KZ,
     Code_LA,
     Code_LB,
     Code_LC,
     Code_LI,
     Code_LK,
     Code_LR,
     Code_LS,
     Code_LT,
     Code_LU,
     Code_LV,
     Code_LY,
     Code_MA,
     Code_MC,
     Code_MD,
     Code_ME,
     Code_MF,
     Code_MG,
     Code_MH,
     Code_MK,
     Code_ML,
     Code_MM,
     Code_MN,
     Code_MO,
     Code_MP,
     Code_MQ,
     Code_MR,
     Code_MS,
     Code_MT,
     Code_MU,
     Code_MV,
     Code_MW,
     Code_MX,
     Code_MY,
     Code_MZ,
     Code_NA,
     Code_NC,
     Code_NE,
     Code_NF,
     Code_NG,
     Code_NI,
     Code_NL,
     Code_NO,
     Code_NP,
     Code_NR,
     Code_NU,
     Code_NZ,
     Code_OM,
     Code_PA,
     Code_PE,
     Code_PF,
     Code_PG,
     Code_PH,
     Code_PK,
     Code_PL,
     Code_PM,
     Code_PN,
     Code_PR,
     Code_PS,
     Code_PT,
     Code_PW,
     Code_PY,
     Code_QA,
     Code_RE,
     Code_RO,
     Code_RS,
     Code_RU,
     Code_RW,
     Code_SA,
     Code_SB,
     Code_SC,
     Code_SD,
     Code_SE,
     Code_SG,
     Code_SH,
     Code_SI,
     Code_SJ,
     Code_SK,
     Code_SL,
     Code_SM,
     Code_SN,
     Code_SO,
     Code_SR,
     Code_SS,
     Code_ST,
     Code_SV,
     Code_SX,
     Code_SY,
     Code_SZ,
     Code_TC,
     Code_TD,
     Code_TF,
     Code_TG,
     Code_TH,
     Code_TJ,
     Code_TK,
     Code_TL,
     Code_TM,
     Code_TN,
     Code_TO,
     Code_TR,
     Code_TT,
     Code_TV,
     Code_TW,
     Code_TZ,
     Code_UA,
     Code_UG,
     Code_UM,
     Code_US,
     Code_UY,
     Code_UZ,
     Code_VA,
     Code_VC,
     Code_VE,
     Code_VG,
     Code_VI,
     Code_VN,
     Code_VU,
     Code_WF,
     Code_WS,
     Code_YE,
     Code_YT,
     Code_ZA,
     Code_ZM,
     Code_ZW,
}
